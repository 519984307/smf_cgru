<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<link href="../../doc/styles.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="images/icon.png" type="image/png">
<title>Afanasy Setup</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Timur Hairulin" />
<meta name="description" content="CGRU: Tools for Houdini, Nuke, Maya, Afanasy - free open source render farm manager" />
<meta name="keywords" content="Houdini, Maya, Nuke, RenderMan, Mantra, Mentalray, prman, Afanasy, animation, rendering, render, farm, manager, free, open source" />
</head>
<body>
<table width="99%" align="center">
<tr align="center">
<td width="33%">
<a href="http://sourceforge.net"><img src="../../doc/images/sflogo.png" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
</td>
<td width="33%">
<p><a href="../../index.html" target="_top"><img src="../../doc/images/cgru16.png" border="0" alt="CGRU" /></a></p>
</td>
<td width="33%">
<a href="http://cgtalk.ru"><img src="../../doc/images/cgtalkru.png" width="88" height="31" border="0" alt="CGTALK.RU Logo" /></a>
</td>
</tr>
</table>

<table width="100%" align="center" cellpadding="0" cellspacing="0">
<tr>
<td width="200px">
<div style="width:100%;height:40px;background:url('../../doc/images/header_left.png')" />
</td>
<td>
<div style="width:100%;height:40px;background:url('../../doc/images/header.png') repeat-x" />
</td>
<td width="200px">
<div style="width:100%;height:40px;background:url('../../doc/images/header_right.png')" />
</td>
</tr>
</table>
<table width="90%" border="0" align="center" cellpadding="0" cellspacing="0"><tr><td>
<!--HEADER-->
<h2 align="center">Afanasy Setup &amp; Launch</h2>
<hr />
<ol>
<li><h4>Setup Environment</h4>
   <p>
   To work proper Afanasy applications need some environment setup.
   You need to setup CGRU and Afanasy environment.
   There are scripts to setup it.
   They based on a working directory.
   To setup CGRU you need to go to CGRU root folder and source setup scripts.
   Afanasy setup is the same.
   </p>
   <ul>
      <li>
         Setup CGRU:<br />
         <code>$ cd .../cgru</code><br />
         <code>$ source setup.sh</code><br/>
         (On MS Windows <code>call setup.cmd</code>)<br/>
      </li>
      <li>
         Setup Afanasy:<br />
         <code>$ cd .../cgru/afanasy/[trunk|branch|tag]</code><br />
         <code>$ source setup.sh</code><br/>
         (On MS Windows <code>call setup.cmd</code>)<br/>
      </li>
   </ul>
   <p>
   Setup puts <kbd>.../cgru/bin</kbd> and <kbd>.../cgru/afanasy/bin</kbd> in <kbd>PATH</kbd>.
   It also appends your <kbd>PYTHONPATH</kbd> to specify python CGRU and Afanasy modules location.
   </p>
   <ul>
   <li>Unix:<br/>
      <p>
      To check Environment you can launch <kbd>afcmd</kbd> command.
      If the program is exists and its output produced no errors, the environment is OK.<br/>
      </p>
      <p>
      To automate terminals setup you can put next line at the end of your <kbd>~/.bashrc</kbd> file:<br/>
      <code>pwd=$PWD; cd .../cgru; source setup.sh; cd afanasy; source setup.sh; cd $pwd</code><br/>
      </p>
   </li>
   </ul>
</li>
<li><h4>Launch</h4>
   <p>
   It is better to launch server and render processes by a special user. Lets name him <kbd>renderer</kbd>.
   </p>
   <code># useradd renderer</code><br/>
   <p>
   This command will create him. Next scripts use this user name.
   </p>
</li>
<li><h4>Create User</h4>
<p>
It is better to launch server and render processes by a special user. Lets name him <kbd>renderer</kbd>.
</p>
<code># useradd renderer</code><br/>
<p>
This command will create him. Next scripts use this user name.
</p>
</li>
<li><h4>Launch Scripts</h4>
<p>
There are some <kbd>bash</kbd> scripts in <code>cgru/afanasy/init</code> directory. They can help you to setup automatic server and render launch. You can manually link <kbd>afserver</kbd> or <kbd>afrender</kbd> script in your startup scripts location  or use <kbd>initlink.sh</kbd> utility to do it.
</p>
<code># ./initlinks.sh [options] afserver</code><br/>
<code># ./initlinks.sh [options] afrender</code><br/>
<p>
You can launch this script with no arguments to output help.
</p>
<p>
This command create a link in <kbd>/etc/init.d</kbd> directory to a file, which located in current directory and name provided in first argument. Put links in <kbd>/etc/rc?.d</kbd> directories to provide service starting and stopping. See script file for details.
</p>
<p>
After this afanasy services will start on machine boot and stop on shutdown automatically. Or you can start and stop them manually  by following commands:
</p>
<code># /etc/init.d/afserver start</code><br/>
<code># /etc/init.d/afserver stop</code><br/>
<code># /etc/init.d/afrender start</code><br/>
<code># /etc/init.d/afrender stop</code><br/>
</li>
<p>
If you starting scripts as <kbd>root</kbd> user, applications will be launched by <kbd>renderer</kbd> user.
You can customize 'non root' username in <kbd>cgru/afanasy/nonrootuser</kbd> file.
</p>
<p>
This starting scripts also provide log rotating. Logs and pid files are stored in <kbd>/var/tmp/afanasy</kbd> directory.
</p>
</ol>
<!--FOOTER-->
</td></tr></table>
<table width="100%" align="center" cellpadding="0" cellspacing="0">
<tr>
<td width="200px">
   <div style="width:100%;height:40px;background:url('../../doc/images/footer_left.png')" />
</td>
<td>
   <div style="width:100%;height:40px;background:url('../../doc/images/footer.png') repeat-x" />
</td>
<td width="200px">
   <div style="width:100%;height:40px;background:url('../../doc/images/footer_center.png')" />
</td>
<td>
   <div style="width:100%;height:40px;background:url('../../doc/images/footer.png') repeat-x" />
</td>
<td width="200px">
   <div style="width:100%;height:40px;background:url('../../doc/images/footer_right.png')" />
</td>
</tr>
</table>

<table width="99%" align="center">
<tr align="center">
<td width="33%">
<small><i><a href="http://sourceforge.net/projects/cgru/"><img src="../../doc/images/sourceforgeproject.png" border="0" alt="SourceForge.net Project" /></a></i></small>
</td>
<td width="33%">
<p><a href="../../index.html" target="_top"><img src="../../doc/images/cgru16.png" border="0" alt="CGRU" /></a></p>
</td>
<td width="33%">
<small><i><a href="http://www.cgtalk.ru/forum/forumdisplay.php?f=168"><img src="../../doc/images/cgtalkforum.png" border="0" alt="cgtalkforum" /></a></i></small>
</td>
</tr>
</table>
</body>
</html>
