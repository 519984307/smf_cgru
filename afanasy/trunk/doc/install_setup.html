<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<link href="../../doc/styles.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="images/icon.png" type="image/png">
<title>Afanasy Setup</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Timur Hairulin" />
<meta name="description" content="CGRU: Tools for Houdini, Nuke, Maya, Afanasy - free open source render farm manager" />
<meta name="keywords" content="Houdini, Maya, Nuke, RenderMan, Mantra, Mentalray, prman, Afanasy, animation, rendering, render, farm, manager, free, open source" />
</head>
<body>
<table width="99%" align="center">
<tr align="center">
<td width="33%">
<a href="http://sourceforge.net"><img src="../../doc/images/sflogo.png" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
</td>
<td width="33%">
<p><a href="../../index.html" target="_top">CGRU</a></p>
</td>
<td width="33%">
<a href="http://cgtalk.ru"><img src="../../doc/images/cgtalkru.png" width="88" height="31" border="0" alt="CGTALK.RU Logo" /></a>
</td>
</tr>
</table>
<table bgcolor="#506030" width="99%"><tr><td><p></p></td></tr></table>
<!--HEADER-->
<h2 align="center">Afanasy Setup</h2>
<hr />
<ol>
<li><h4>Setup Environment</h4>
   <p>
   Environment needed to fill $PATH with CGRU commands and to specify configuration files location.<br/>
   Go into CGRU top directory:<br />
   <code>$ cd cgru/afanasy/[trunk|branch|tag]</code><br />
   Source script which exports some variables:<br />
   <code>$ source setup.sh</code><br />
   Also this setup appends your $PYTHONPATH to specify python CGRU modules location.
   </p>
   <p>
   To automate process you can put next line at the end of your <kbd>~/.bashrc</kbd> file:<br/>
   <code>pwd=$PWD; cd .../afanasy/...; source setup.sh; cd $pwd</code><br/>
   </p>
</li>
<li><h4>Check Environment</h4>
   <kbd>afanasy/bin</kbd> must be in <kbd>PATH</kbd>, so you can launch afanasy programs<br/>
   Launch <kbd>afcmd</kbd> to check it. If programs is exists and output produced no errors, environment is OK.<br/>
</li>
<li><h4>Create User</h4>
<p>
It is better to launch server and render processes by a special user. Lets name him <kbd>renderer</kbd>.
</p>
<code># useradd renderer</code><br/>
<p>
This command will create him. Next scripts use this user name.
</p>
</li>
<li><h4>Launch Scripts</h4>
<p>
There are some <kbd>bash</kbd> scripts in <code>cgru/afanasy/init</code> directory. They can help you to setup automatic server and render launch. You can manually link <kbd>afserver</kbd> or <kbd>afrender</kbd> script in your startup scripts location  or use <kbd>initlink.sh</kbd> utility to do it.
</p>
<code># ./initlinks.sh [options] afserver</code><br/>
<code># ./initlinks.sh [options] afrender</code><br/>
<p>
You can launch this script with no arguments to output help.
</p>
<p>
This command create a link in <kbd>/etc/init.d</kbd> directory to a file, which located in current directory and name provided in first argument. Put links in <kbd>/etc/rc?.d</kbd> directories to provide service starting and stopping. See script file for details.
</p>
<p>
After this afanasy services will start on machine boot and stop on shutdown automatically. Or you can start and stop them manually  by following commands:
</p>
<code># /etc/init.d/afserver start</code><br/>
<code># /etc/init.d/afserver stop</code><br/>
<code># /etc/init.d/afrender start</code><br/>
<code># /etc/init.d/afrender stop</code><br/>
</li>
<p>
If you starting scripts as <kbd>root</kbd> user, applications will be launched by <kbd>renderer</kbd> user.
You can customize 'non root' username in <kbd>cgru/afanasy/nonrootuser</kbd> file.
</p>
<p>
This starting scripts also provide log rotating. Logs and pid files are stored in <kbd>/var/tmp/afanasy</kbd> directory.
</p>
</ol>
<!--FOOTER-->
<br/>
<table bgcolor="#506030" width="99%"><tr><td><p></p></td></tr></table>
<br/>
<table width="99%" align="center">
<tr align="center">
<td width="33%">
<small><i><a href="http://sourceforge.net/projects/cgru/">SourceForge.net Project</a></i></small>
</td>
<td width="33%">
<p><a href="../../index.html" target="_top">CGRU</a></p>
</td>
<td width="33%">
<small><i><a href="http://www.cgtalk.ru/forum/forumdisplay.php?f=168">Раздел на форуме CGTALK.RU</a></i></small>
</td>
</tr>
</table>
</body>
</html>
